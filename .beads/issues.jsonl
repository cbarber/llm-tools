{"id":"llm-tools-0jy","title":"Add next-session handoff prompt to session completion template","description":"Problem: The 'Landing the Plane' section in AGENTS.md step 7 says 'Hand off - Provide context for next session' but doesn't specify the format. This causes agents to provide summaries TO the user instead of preparing a prompt FOR the next AI session, breaking continuity between sessions.\n\nProposed Solution:\nUpdate both agents/templates/default.md (shared template) and AGENTS.md (this repo's instructions) to clarify step 7 should produce a ready-to-paste prompt containing:\n- Current repository state (branch, commit hash, working tree status)\n- What was just completed (closed issues, commits pushed)\n- Ready issues with IDs and priorities\n- Important context for continuity\n\nExample format:\n```\n## Next Session Prompt\n\nCurrent State (YYYY-MM-DD)\n- Branch: main (abc1234)\n- Working tree: clean\n- Recent work: [summary]\n\nReady Issues:\n1. issue-id (P1): Title\n   - Key context\n\n2. issue-id (P2): Title\n   - Key context\n\nContext:\n- Important details for next session\n```\n\nThis ensures the next AI session has proper context without requiring the user to manually brief it.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T20:42:43.994565298-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:45:09.286013179-05:00","closed_at":"2025-12-27T20:45:09.286013179-05:00","close_reason":"Added explicit handoff prompt format to AGENTS.md and agents/templates/default.md"}
{"id":"llm-tools-15x","title":"Improve precision in agents/templates/default.md word choices","description":"## Context\n\nAudit identified 13 imprecise word choices in agents/templates/default.md that reduce clarity:\n- Ambiguous terms ('terse', 'strategic', 'quality gates')\n- Vague directives ('if necessary', 'side effects', 'check state')\n- Negative framing (what NOT to do vs what TO do)\n- Passive voice obscuring agency\n- Jargon lacking operational definitions\n\n## Decision Criteria\n\nWhen revising word choices:\n1. **Precision over brevity** - Choose terms with single clear interpretation\n2. **Positive directives** - Specify desired behavior, not prohibited behavior\n3. **Concrete over abstract** - Prefer actionable terms ('run git status' vs 'check state')\n4. **Active voice** - Make agent responsibility explicit\n5. **No jargon** - Replace domain terms with plain language when possible\n6. **Maintain terseness** - Edits should maintain or reduce line length\n\n## Reconciliation Required\n\n**CRITICAL**: Changes to default.md must be reconciled with AGENTS.md:\n- AGENTS.md is the canonical source used by this repository\n- default.md is the template for user repositories\n- Both files share overlapping guidelines (commit format, PR workflow, session completion)\n- Word choice improvements should apply consistently to both files\n\n**Process:**\n1. Read current AGENTS.md to identify matching sections\n2. Apply precision improvements to default.md\n3. Backport applicable changes to AGENTS.md\n4. Verify both files use consistent terminology\n5. Test that improved language doesn't conflict with existing workflows\n\n**Example conflicts to check:**\n- 'terse' appears in both files - ensure consistent replacement\n- Commit message guidance duplicated - update both\n- Session completion checklist - verify step wording matches\n\nNote: Audit was performed on specific line numbers that may shift if template evolves before this work begins.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T06:19:11.666652997Z","created_by":"cbarber","updated_at":"2026-01-01T06:20:19.991389998Z"}
{"id":"llm-tools-1us","title":"Research Jujutsu (jj) for agent workflows","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:56:32.608234714Z","created_by":"cbarber","updated_at":"2026-01-01T17:58:13.408139498Z","closed_at":"2026-01-01T17:58:13.408139498Z","close_reason":"Closed"}
{"id":"llm-tools-44v","title":"Research modern Git workflows for agents","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:56:33.854455736Z","created_by":"cbarber","updated_at":"2026-01-01T17:58:13.414621944Z","closed_at":"2026-01-01T17:58:13.414621944Z","close_reason":"Closed"}
{"id":"llm-tools-5lq","title":"Test worktree sync","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T05:08:57.370915072Z","created_by":"cbarber","updated_at":"2025-12-31T05:09:33.535400286Z","closed_at":"2025-12-31T05:09:33.535400286Z","close_reason":"Closed"}
{"id":"llm-tools-6dl","title":"Split template commit into atomic changes","description":"Commit e508a7c combines: 1) succinct template, 2) workflow revisions, 3) word choice (terseâ†’succinct). Split and reconcile with AGENTS.md","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-31T16:02:00.32071916Z","created_by":"cbarber","updated_at":"2025-12-31T16:02:00.32071916Z"}
{"id":"llm-tools-7u8","title":"Design git hooks for workflow enforcement","description":"Shell functions vs git hooks. Check existing hooks (beads), worktree compatibility, sandbox .git resolution","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-31T16:02:00.731465145Z","created_by":"cbarber","updated_at":"2025-12-31T16:02:00.731465145Z"}
{"id":"llm-tools-8w9","title":"Prototype workflow boundary injection for OpenCode","description":"Build temper tool for OpenCode: extract markdown sections, inject at session start (plugin), commit (shell), PR create (shell). Simplify AGENTS.md structure for parsing.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-31T19:05:07.554419912Z","created_by":"cbarber","updated_at":"2025-12-31T19:28:48.134427927Z","closed_at":"2025-12-31T19:28:48.134427927Z","close_reason":"Prototype complete: temper tool built, injection points implemented (session start, commit, PR), tested successfully"}
{"id":"llm-tools-912","title":"Improve agent handoff template clarity","description":"Workflow gaps: handoff lacks next action, branch status ambiguous (continued on merged branch), too much detail in some sections","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T14:59:07.373336412Z","created_by":"cbarber","updated_at":"2025-12-31T15:00:54.627047414Z","closed_at":"2025-12-31T15:00:54.627047414Z","close_reason":"Template improved: added session start workflow, clearer branch lifecycle, mandatory next action in handoffs"}
{"id":"llm-tools-9rs","title":"Research Sapling for agent workflows","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:56:33.276933744Z","created_by":"cbarber","updated_at":"2026-01-01T17:58:13.412651521Z","closed_at":"2026-01-01T17:58:13.412651521Z","close_reason":"Closed"}
{"id":"llm-tools-ak0","title":"Refactor CLAUDE.local.md to AGENTS.md with CLAUDE.md symlink","description":"Reconcile CLAUDE.md and AGENTS.md by making AGENTS.md the primary file with CLAUDE.md as a symlink. This consolidates documentation and follows beads convention. Will require updating CLAUDE file checking logic in shell setup to handle symlinks. Currently we check for CLAUDE.md or CLAUDE.local.md - need to add AGENTS.md to precedence and create CLAUDE.md symlink when appropriate.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:20:02.501412493-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:22:20.590433067-05:00","closed_at":"2025-12-27T20:22:20.590433067-05:00","close_reason":"Refactored shell setup to use AGENTS.md as primary file with CLAUDE.md as symlink. Tested template creation and backward compatibility with existing CLAUDE.md files."}
{"id":"llm-tools-bd5","title":"Test and validate bubblewrap agent sandboxing","description":"Verify the agent-sandbox.sh prototype actually works as intended. Test cases: 1) Can agent access files outside project dir? 2) Does mktemp work directory get created? 3) Is cleanup reliable on exit? 4) Do agents have necessary tool access (git, editors)? 5) Performance impact measurement. The exploration in llm-tools-yyo was closed prematurely - research and prototype don't equal validation.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-27T20:57:44.693271035-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:57:44.693271035-05:00"}
{"id":"llm-tools-boh","title":"Review completed work incrementally instead of batch completing","description":"User feedback: I worked on three issues (llm-tools-0jy, llm-tools-bzj, llm-tools-yyo) without pausing for review after completing each one. Better approach: complete one issue, ask for user review/feedback, then proceed to next. This allows course correction and ensures work meets expectations before moving forward. Apply to future sessions.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T20:57:51.488278735-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:57:51.488278735-05:00"}
{"id":"llm-tools-bzj","title":"Support user-specific templates for CLAUDE/AGENTS.md","description":"Allow users to customize agent templates based on their username/GitHub handle. Potential approaches: 1) Nix flake variant: nix develop ~/src/llm-tools#claude-code.cbarber 2) Auto-detect from USER env var or git config user.name 3) Template directory structure: agents/claude-code/templates/{default,cbarber,etc}.md. Benefits: personalized instructions, team-specific workflows, easy to share common patterns. Depends on: llm-tools-ak0 (CLAUDE/AGENTS.md refactor). Consider: template precedence, fallback to default, documentation for creating custom templates.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-27T19:10:43.280685476-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:47:03.821065114-05:00","closed_at":"2025-12-27T20:47:03.821065114-05:00","close_reason":"Implemented user-specific template support with fallback to default","dependencies":[{"issue_id":"llm-tools-bzj","depends_on_id":"llm-tools-ak0","type":"blocks","created_at":"2025-12-27T19:10:52.254480336-05:00","created_by":"daemon"}]}
{"id":"llm-tools-d1w","title":"Add forge pr review-reply command for threaded review comment replies","description":"Currently forge only supports general PR comments via 'pr comment', but agents often need to reply to specific code review comments on file lines.\n\nProblem:\n- 'forge pr review-comments 6' shows review comments (read-only)\n- 'forge pr comment 6 text' posts general comment (not threaded to specific review)\n- No way to reply to specific file/line review comments through forge\n\nProposed solution:\nAdd 'pr review-reply' command that posts threaded replies to specific review comments.\n\nExample workflow:\n$ forge pr review-comments 6\n[1] tools/fix-beads-hooks:33-34 @ be29b8f [comment-id: 123456]\n    Comment: Woah. This is bad...\n\n$ forge pr review-reply 6 123456 \"Fixed in commit abc123\"\nPosted reply to review comment 123456\n\nInvestigation needed:\n- Check if gh/tea CLI support review comment replies via API\n- If not supported, document limitation in help text\n- Consider interactive mode for easier workflow","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-31T14:28:44.763223271Z","created_by":"cbarber","updated_at":"2025-12-31T14:28:44.763223271Z"}
{"id":"llm-tools-f6z","title":"Implement automatic cleanup of agent work directory on shell exit","description":"Question from user: does nix have a postShellHook for cleanup? Research: 1) How to create mktemp directory in shellHook, 2) How to ensure cleanup on shell exit (trap? nix hook?), 3) Should cleanup use rm -rf or safer alternative (prevent symlink following), 4) Integration with agent-sandbox.sh. Goal: jail agents to project dir + auto-cleaned temp workspace.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T20:57:48.120253227-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:57:48.120253227-05:00"}
{"id":"llm-tools-qog","title":"Support XDG git config in sandbox","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-31T14:40:46.573293797Z","created_by":"cbarber","updated_at":"2025-12-31T14:41:57.672223489Z","closed_at":"2025-12-31T14:41:57.672223489Z","close_reason":"Fixed by mounting ~/.config/git/config in Linux sandbox"}
{"id":"llm-tools-qq8","title":"Research contextual instruction injection patterns","description":"How do others solve workflow-stage-specific prompting? AGENTS.md composition strategies? Small steps to embrace it?","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T16:02:01.231342482Z","created_by":"cbarber","updated_at":"2026-01-01T18:04:21.664867777Z","closed_at":"2026-01-01T18:04:21.664867777Z","close_reason":"Comprehensive research completed on non-interactive commit splitting techniques"}
{"id":"llm-tools-txa","title":"Research git tools for atomic commits and stacked diffs","description":"Investigate git-absorb, spr, jujutsu, git-branchless for LLM agent workflows. Focus on: 1) Auto-fixing mixed commits (git-absorb), 2) Stacked diffs vs atomic commits workflow, 3) Non-interactive tooling for agents, 4) Integration into llm-tools agent workflow. Goal: Make commit management more precise and less error-prone for agents.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T19:57:32.482537114Z","created_by":"cbarber","updated_at":"2026-01-01T19:57:32.482537114Z"}
{"id":"llm-tools-tze","title":"Extract shell hooks to separate script files","description":"Extract shell hooks from agents/*/default.nix into separate .sh files to avoid Nix string escaping issues (double-quote-quote-dollar-brace breaks tree-sitter), improve diff clarity, and follow existing setup-*.sh pattern. Benefits: better syntax highlighting, easier testing, cleaner version control.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:19:38.457290933-05:00","created_by":"cbarber","updated_at":"2025-12-27T19:32:10.563797044-05:00","closed_at":"2025-12-27T19:32:10.563797044-05:00","close_reason":"Extracted shell hooks from agents/*/default.nix into separate setup-shell.sh files. This improves syntax highlighting, eliminates Nix string escaping issues, and makes diffs cleaner."}
{"id":"llm-tools-y7o","title":"Improve forge help to clarify review comments vs general comments","description":"Agent confusion: tried to use 'forge pr comment' to reply to code review comments, but it only posts general PR comments. The distinction between review comments (file/line) and general comments isn't clear.\n\nCurrent help shows:\n  pr comment [NUMBER] TEXT\n  pr review-comments [NUMBER] [--json]\n\nIssues:\n1. Doesn't clarify that 'pr comment' posts general comments only\n2. Doesn't explain that review-comments is read-only\n3. No guidance on how to reply to review comments\n4. Missing common workflow examples\n\nImprovements:\n1. Add clarifying descriptions:\n   pr comment [NUMBER] TEXT            # Post general PR comment (not threaded reply)\n   pr review-comments [NUMBER]         # View code review comments (read-only)\n\n2. Add --examples flag with common workflows\n3. Better error messages suggesting correct commands\n4. Document limitations (if review replies aren't supported)\n\nReal-world agent mistake:\n- Wanted to reply to specific review comment on line 33\n- Used 'pr comment' thinking it would thread the reply\n- Actually posted general comment instead\n- Should have been guided to correct approach","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-31T14:28:51.347704582Z","created_by":"cbarber","updated_at":"2025-12-31T14:28:51.347704582Z"}
{"id":"llm-tools-y7q","title":"Research Jujutsu (jj) VCS for LLM agent automation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-01T19:20:26.266776874Z","created_by":"cbarber","updated_at":"2026-01-01T19:20:26.266776874Z"}
{"id":"llm-tools-yyo","title":"Explore chroot for CLI agent startup constraints","description":"Investigate using chroot to constrain CLI agents on startup for better security and isolation. Requirements: provide /tmp access, use mktemp for agent work directory, remove work directory on exit (no symlink following). Benefits: prevent agents from accessing files outside project scope, temporary workspace cleanup, reduced security risk. Considerations: how to handle tool access (git, editors, etc), bind mounts for necessary directories, performance impact.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T19:05:06.440200388-05:00","created_by":"cbarber","updated_at":"2025-12-27T20:48:29.088854106-05:00","closed_at":"2025-12-27T20:48:29.088854106-05:00","close_reason":"Completed exploration: bubblewrap preferred over chroot, created prototype sandbox wrapper"}
